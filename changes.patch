diff --git a/USER_GUIDE.md b/USER_GUIDE.md
index f63afce..ac6d4b4 100644
--- a/USER_GUIDE.md
+++ b/USER_GUIDE.md
@@ -140,18 +140,39 @@ To use the `fastmcp` server in HTTP mode (SSE):
     The server will start on `http://0.0.0.0:8000`.
 
 3.  **Configure Client (e.g., VS Code/Cursor):**
-    Update your `mcp.json` to use the SSE endpoint:
+    Update your `mcp.json` to use the SSE endpoint with authentication credentials in the URL query parameters:
 
+    **For Gemini:**
+    ```json
+    {
+      "mcpServers": {
+        "accuknox-http": {
+          "httpUrl": "http://localhost:8000/mcp",
+          "headers": {
+            "token": "YOUR_API_TOKEN",
+            "base_url": "https://cspm.demo.accuknox.com"
+          }
+        }
+      }
+    }
+    ```
+
+    **For Cursor:**
     ```json
     {
       "mcpServers": {
         "accuknox-http": {
           "url": "http://localhost:8000/mcp",
-          "type": "sse"
+          "type": "http",
+          "headers": {
+            "Token": "YOUR_API_TOKEN",
+            "Base_url": "https://cspm.demo.accuknox.com"
+          }
         }
       }
     }
     ```
+    *Note: Replace `YOUR_API_TOKEN` with your actual AccuKnox API token. The `base_url` can still be passed as a query parameter if needed.*
 
 ---
 
diff --git a/fastmcp_server.py b/fastmcp_server.py
index bcc1283..18fc26e 100644
--- a/fastmcp_server.py
+++ b/fastmcp_server.py
@@ -4,7 +4,7 @@ import warnings
 from typing import Any, Dict, Literal, Optional
 
 import httpx
-from fastmcp import FastMCP
+from fastmcp import Context, FastMCP
 from starlette.requests import Request
 from starlette.responses import JSONResponse, PlainTextResponse
 
@@ -16,6 +16,64 @@ from shared.utils.finding import (
     _normalize_dict,
 )
 
+
+def _get_auth_context(ctx: Context) -> tuple[Optional[str], Optional[str]]:
+    """Helper to extract auth context from request"""
+    default_base_url = "https://cspm.demo.accuknox.com"
+
+    if not ctx:
+        logging.warning("No context provided")
+        return default_base_url, None
+    logging.warning("Context provided")
+    try:
+        req = ctx.get_http_request()
+
+        print(req.headers)
+        if not req:
+            logging.warning("No HTTP request found")
+            return default_base_url, None
+
+        logging.warning("HTTP request found")
+        headers = req.headers
+        token = headers.get("Token")
+        if token:
+            token = token.strip()
+        base_url = headers.get("Base_url")
+
+        logging.warning(
+            f"Extracted from headers - Token: {'Yes' if token else 'No'}, Base URL: {base_url}",
+        )
+
+        # Fallback: Check query parameters
+        if not token:
+            logging.warning("Token not found in headers, checking query parameters")
+            token = req.query_params.get("token") or req.query_params.get("api_token")
+        if not base_url:
+            logging.warning("Base URL not found in headers, checking query parameters")
+            base_url = req.query_params.get("base_url")
+
+        # Default to demo URL if still missing
+        if not base_url:
+            logging.warning("Base URL not found, using default URL")
+            base_url = default_base_url
+
+        auth_headers = None
+        if token:
+            # Reconstruct headers for call_api
+            logging.warning("Token found")
+            auth_headers = {
+                "Authorization": f"Bearer {token}",
+                "Content-Type": "application/json",
+            }
+            return base_url, token
+
+        return base_url, auth_headers
+
+    except Exception as e:
+        logging.error(f"Failed to extract auth context: {e}")
+        return default_base_url, None
+
+
 # Initialize FastMCP server for HTTP
 mcp = FastMCP(
     "AccuKnox Assets Server",
@@ -74,6 +132,7 @@ async def search_assets(
     deployed: Optional[bool] = None,
     present_on_date_after: Optional[str] = None,
     present_on_date_before: Optional[str] = None,
+    ctx: Context = None,
 ) -> str:
     """
     READ-ONLY: Search and filter cloud infrastructure assets.
@@ -92,6 +151,7 @@ async def search_assets(
         deployed: Optional[bool]. Set to True for deployed models, False for undeployed models, or None (default) to ignore deployment status.
         present_on_date_after: Filter assets present on or after this date. Format: YYYY-MM-DD. Defaults to two days ago if not provided.
         present_on_date_before: Filter assets present on or before this date. Format: YYYY-MM-DD. Defaults to now if not provided
+        ctx: FastMCP Context (injected automatically)
 
     Returns:
         Formatted asset list, count, or model statistics
@@ -103,8 +163,22 @@ async def search_assets(
         - "List AWS assets" â†’ cloud_provider="aws"
         - "Show assets with security details" â†’ detailed=True
     """
+    # Dynamic Authentication Logic
+    # Dynamic Authentication Logic
+    client = api_client  # Default to global client
+
+    base_url, token = _get_auth_context(ctx)
+    if base_url and token:
+        logging.info(f"Initializing AccuKnoxClient with base_url: {base_url}")
+        logging.warning(f"Creating new AccuKnoxClient with provided context {token}")
+        # Extract token from headers if available for AccuKnoxClient
+
+        client = AccuKnoxClient(base_url=base_url, api_token=token)
+    else:
+        logging.warning("Using global api_client (might be unconfigured)")
+
     return await search_assets_tool(
-        api_client,
+        client,
         asset_id,
         type_name,
         type_category,
@@ -156,7 +230,7 @@ async def data_type_selection() -> dict:
 
 
 @mcp.tool
-async def get_finding_config(data_type: str | None = None) -> dict:
+async def get_finding_config(data_type: str | None = None, ctx: Context = None) -> dict:
     """
     MCP Tool: Retrieve finding configuration metadata for a given data type.
 
@@ -184,7 +258,8 @@ async def get_finding_config(data_type: str | None = None) -> dict:
             - order_by:
                 Default sorting field for findings.
     """
-    return await _get_finding_config(data_type)
+    base_url, headers = _get_auth_context(ctx)
+    return await _get_finding_config(data_type, base_url=base_url, headers=headers)
 
 
 @mcp.tool
@@ -197,6 +272,7 @@ async def get_finding(
     display_fields: dict | str | None = None,
     group_by: Optional[str] = None,
     search: str = "",
+    ctx: Context = None,
 ) -> dict:
     """
     MCP Tool to fetch findings.
@@ -223,6 +299,7 @@ async def get_finding(
     """
     extra_filters = _normalize_dict(extra_filters)
     display_fields = _normalize_dict(display_fields)
+    base_url, headers = _get_auth_context(ctx)
     return await _fetch_findings(
         data_type=data_type,
         ordering=ordering,
@@ -232,6 +309,8 @@ async def get_finding(
         display_fields=display_fields,
         group_by=group_by,
         search=search,
+        base_url=base_url,
+        headers=headers,
     )
 
 
@@ -240,6 +319,7 @@ async def get_finding_filter(
     filter_field: str,
     data_type: str,
     filter_search: Optional[str] = "",
+    ctx: Context = None,
 ) -> dict:
     """
     Returns dropdown filter values for a given filter_field + data_type only for finding.
@@ -253,10 +333,13 @@ async def get_finding_filter(
     Returns:
         dict: { filter_field, count, results }
     """
+    base_url, headers = _get_auth_context(ctx)
     return await _finding_filter(
         filter_field=filter_field,
         data_type=data_type,
         filter_search=filter_search or "",
+        base_url=base_url,
+        headers=headers,
     )
 
 
@@ -269,7 +352,7 @@ if __name__ == "__main__":
     print(f"ðŸ’š http://0.0.0.0:8000/health")
     print("=" * 70)
 
-    # THE KEY FIX: Use with_sse=False to disable Accept header checking
+    # Use SSE transport for persistent connection and better client compatibility
     mcp.run(
         transport="http",
         host="0.0.0.0",
diff --git a/shared/api.py b/shared/api.py
index 01da1d4..06f539a 100644
--- a/shared/api.py
+++ b/shared/api.py
@@ -3,8 +3,9 @@ AccuKnox API Client
 Handles all API interactions with AccuKnox CSPM
 """
 
+import logging
 import os
-from typing import Optional
+from typing import Any, Dict, List, Optional
 
 import httpx
 from dotenv import load_dotenv
@@ -17,9 +18,13 @@ load_dotenv()
 class AccuKnoxClient:
     """Client for AccuKnox CSPM API"""
 
-    def __init__(self):
-        self.base_url = os.getenv("ACCUKNOX_BASE_URL", "").rstrip("/")
-        self.api_token = os.getenv("ACCUKNOX_API_TOKEN", "")
+    def __init__(self, base_url: Optional[str] = None, api_token: Optional[str] = None):
+        self.base_url = (base_url or os.getenv("ACCUKNOX_BASE_URL", "")).rstrip("/")
+        logging.info(f"AccuKnoxClient initialized with base_url: '{self.base_url}'")
+        self.api_token = api_token or os.getenv("ACCUKNOX_API_TOKEN", "")
+        logging.warning(
+            f"AccuKnoxClient initialized with api_token: '{self.api_token}' , base_url: '{self.base_url}'",
+        )
         self.headers = {
             "Authorization": f"Bearer {self.api_token}",
             "Content-Type": "application/json",
@@ -41,6 +46,7 @@ class AccuKnoxClient:
         """Fetch assets from AccuKnox"""
 
         endpoint = f"{self.base_url}/api/v1/assets"
+        logging.warning(f"Fetching assets from endpoint: {endpoint}")
         params = {"page": page, "page_size": page_size}
 
         if asset_id:
@@ -60,6 +66,9 @@ class AccuKnoxClient:
             params["present_on_date_before"] = present_on_date_before
 
         async with httpx.AsyncClient() as client:
+            logging.warning(
+                f"Making request to {endpoint} with tokens {self.api_token} and params {params}",
+            )
             response = await client.get(
                 endpoint,
                 headers=self.headers,
diff --git a/shared/tools.py b/shared/tools.py
index 7585baf..a37b012 100644
--- a/shared/tools.py
+++ b/shared/tools.py
@@ -3,6 +3,7 @@ Tool Implementations
 Shared between stdio and HTTP servers
 """
 
+import logging
 from datetime import datetime, timedelta, timezone
 from typing import Optional
 
@@ -222,6 +223,7 @@ async def search_assets_tool(
     present_on_date_before: Optional[str] = None,
 ) -> str:
     """Search assets tool implementation"""
+    logging.warning(f" client details {client.api_token} , {client.base_url}")
 
     try:
         # # If requesting deployed models statistics
diff --git a/shared/utils/api_utils.py b/shared/utils/api_utils.py
index 538f417..092c660 100644
--- a/shared/utils/api_utils.py
+++ b/shared/utils/api_utils.py
@@ -37,6 +37,8 @@ async def call_api(
     params: Optional[Dict[str, Any]] = None,
     data: Optional[Dict[str, Any]] = None,
     timeout: float = 30.0,
+    base_url_override: Optional[str] = None,
+    headers: Optional[Dict[str, str]] = None,
 ) -> dict:
     """
     Utility function to call GET or POST APIs.
@@ -48,25 +50,33 @@ async def call_api(
         params: Optional query parameters for GET requests.
         data: Optional JSON body for POST requests.
         timeout: Request timeout in seconds.
+        base_url_override: Optional base URL to use instead of the configured one.
+        headers: Optional headers to use instead of the default ones.
 
     Returns:
         Parsed JSON response as a dictionary.
     """
-    base_url = BASE_URLS.get(base_url_type)
+    if base_url_override:
+        base_url = base_url_override.rstrip("/")
+    else:
+        base_url = BASE_URLS.get(base_url_type)
+
     if not base_url:
         raise ValueError(f"Base URL for '{base_url_type}' is not configured.")
 
     url = f"{base_url}/{endpoint.lstrip('/')}"
     logger.info(f"API endpoint {url}, {params}, {data}")
 
+    request_headers = headers if headers is not None else HEADERS
+
     async with httpx.AsyncClient(timeout=timeout) as client:
         try:
             if method.upper() == "GET":
-                response = await client.get(url, headers=HEADERS, params=params)
+                response = await client.get(url, headers=request_headers, params=params)
             elif method.upper() == "POST":
                 response = await client.post(
                     url,
-                    headers=HEADERS,
+                    headers=request_headers,
                     json=data,
                     params=params,
                 )
diff --git a/shared/utils/finding.py b/shared/utils/finding.py
index 944bfa9..e80306a 100644
--- a/shared/utils/finding.py
+++ b/shared/utils/finding.py
@@ -53,14 +53,23 @@ vul_data_map = {
 }
 
 
-async def _get_finding_config(data_type: str | None = None) -> dict:
+async def _get_finding_config(
+    data_type: str | None = None,
+    base_url: Optional[str] = None,
+    headers: Optional[Dict[str, str]] = None,
+) -> dict:
     """
     Fetch and return the finding configuration for a given data_type.
     If data_type is None, returns the first config by default.
     """
 
     endpoint = "api/v1/vulnerability-configs/filters-data-config"
-    configs = await call_api(endpoint, method="GET")
+    configs = await call_api(
+        endpoint,
+        method="GET",
+        base_url_override=base_url,
+        headers=headers,
+    )
     data_types = []
 
     for cfg in configs:
@@ -137,7 +146,13 @@ def _normalize_dict(value):
     raise ValueError("Expected dict or JSON string")
 
 
-async def validate_filters(extra_filters: dict, data_type: str, filter_fields: dict):
+async def validate_filters(
+    extra_filters: dict,
+    data_type: str,
+    filter_fields: dict,
+    base_url: Optional[str] = None,
+    headers: Optional[Dict[str, str]] = None,
+):
     if not extra_filters:
         return {}, {}
     tasks = []
@@ -177,6 +192,8 @@ async def validate_filters(extra_filters: dict, data_type: str, filter_fields: d
                     filter_field=key,
                     data_type=data_type,
                     filter_search=value,
+                    base_url=base_url,
+                    headers=headers,
                 ),
             )
 
@@ -212,6 +229,8 @@ async def _fetch_findings(
     display_fields: Optional[Dict[str, Any]] = None,
     group_by: Optional[str] = None,
     search: str = "",
+    base_url: Optional[str] = None,
+    headers: Optional[Dict[str, str]] = None,
 ) -> dict:
     """
     Internal flexible finding fetcher.
@@ -222,7 +241,11 @@ async def _fetch_findings(
     - Applies default filters: status=Active, ignored=False
     """
     if not config_maps:
-        config = await _get_finding_config(data_type)
+        config = await _get_finding_config(
+            data_type,
+            base_url=base_url,
+            headers=headers,
+        )
     else:
         config = config_maps.get(data_type)
     if not config:
@@ -240,6 +263,8 @@ async def _fetch_findings(
         extra_filters or {},
         data_type,
         filter_fields,
+        base_url=base_url,
+        headers=headers,
     )
     if invalid_filter:
         return invalid_filter
@@ -258,7 +283,13 @@ async def _fetch_findings(
         params["group_by"] = group_by
         params["group_by_order"] = "-total"
 
-    response = await call_api("api/v1/finding-dashboard", method="GET", params=params)
+    response = await call_api(
+        "api/v1/finding-dashboard",
+        method="GET",
+        params=params,
+        base_url_override=base_url,
+        headers=headers,
+    )
 
     if display_fields is None:
         return {"count": response.get("count", 0)}
@@ -289,6 +320,8 @@ async def _finding_filter(
     filter_field: str,
     data_type: str,
     filter_search: str = "",
+    base_url: Optional[str] = None,
+    headers: Optional[Dict[str, str]] = None,
 ) -> dict:
     """
     Fetch filter dropdown values for a given filter_field + data_type.
@@ -308,6 +341,8 @@ async def _finding_filter(
         "api/v1/finding-dashboard/filter-values",
         method="GET",
         params=params,
+        base_url_override=base_url,
+        headers=headers,
     )
 
     return {
